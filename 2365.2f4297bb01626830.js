"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2365],{2365:(Ve,I,p)=>{p.r(I),p.d(I,{DeliveryPageModule:()=>ze});var y=p(6814),m=p(95),g=p(2912),w=p(7168),u=p(5861),e=p(5678),C=p(6676),x=p(5083),P=p(8439),k=p(8816),A=p(4387);const J=["debug"],q=["popoverAction"];function N(o,c){if(1&o&&(e.TgZ(0,"h6",16),e._uU(1),e.TgZ(2,"small",17),e._uU(3),e.ALo(4,"COP"),e.qZA()()),2&o){const t=e.oxw();e.xp6(1),e.hij(" ",t.isNew?"Nuevo Viaje":"Viaje"," "),e.xp6(2),e.hij(" Total ",e.lcZ(4,2,t.getTotalDeliveryPrice())," ")}}function L(o,c){1&o&&e._UZ(0,"ion-skeleton-text",18),2&o&&e.Q6J("animated",!0)}function Q(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"ion-button",26),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.onPrevious())}),e._UZ(1,"ion-icon",27),e._uU(2," Atr\xe1s "),e.qZA()}}function U(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"ion-button",26),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.onNext())}),e._uU(1,"Siguiente "),e._UZ(2,"ion-icon",28),e.qZA()}}function F(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"ion-button",29),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.presentOnFinish())}),e._uU(1,"Finalizar "),e._UZ(2,"ion-icon",28),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("disabled",0==t.getTotalDeliveryPrice())}}function Y(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"ion-content",31),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(3);return e.KtG(n.presentClearCurrent())}),e._uU(1,"Borrar datos!"),e.qZA()}}function H(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"ion-content",31),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(3);return e.KtG(n.presentDeleteDelivery())}),e._uU(1),e.ALo(2,"COP"),e.qZA()}if(2&o){const t=e.oxw(3);e.xp6(1),e.hij("Borrar Viaje de ",e.lcZ(2,1,t.getTotalDeliveryPrice()),"!")}}function E(o,c){if(1&o){const t=e.EpF();e.YNc(0,Y,2,0,"ion-content",30)(1,H,3,3,"ion-content",30),e.TgZ(2,"ion-content",31),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2);return n.closePopover(),e.KtG(n.goToDeliveryList())}),e._uU(3,"Cerrar Viaje!"),e.qZA()}if(2&o){const t=e.oxw(2);e.Q6J("ngIf",t.isNew),e.xp6(1),e.Q6J("ngIf",!t.isNew)}}function K(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"ion-buttons",19),e.YNc(1,Q,3,0,"ion-button",20)(2,U,3,0,"ion-button",20)(3,F,3,1,"ion-button",21),e.TgZ(4,"ion-button",22),e.NdJ("click",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.presentPopoverAction(n))}),e._UZ(5,"ion-icon",23),e.qZA(),e.TgZ(6,"ion-popover",24,25),e.NdJ("didDismiss",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.isOpen=!1)}),e.YNc(8,E,4,2,"ng-template"),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.counter>1),e.xp6(1),e.Q6J("ngIf",t.counter<=3),e.xp6(1),e.Q6J("ngIf",4==t.counter),e.xp6(3),e.Q6J("isOpen",t.isOpen)}}const M=()=>({color:"red"});function G(o,c){1&o&&e._UZ(0,"ion-icon",40),2&o&&e.Q6J("ngStyle",e.DdM(1,M))}function z(o,c){if(1&o&&(e.TgZ(0,"ion-badge",19),e._uU(1),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.Oqu(t.getProviderListSelectedLength())}}function V(o,c){1&o&&e._UZ(0,"ion-icon",40),2&o&&e.Q6J("ngStyle",e.DdM(1,M))}function j(o,c){if(1&o&&(e.TgZ(0,"ion-badge",19),e._uU(1),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.Oqu(t.getClientsSelectedLength())}}function B(o,c){1&o&&e._UZ(0,"ion-icon",40),2&o&&e.Q6J("ngStyle",e.DdM(1,M))}function $(o,c){if(1&o&&(e.TgZ(0,"ion-badge",19),e._uU(1),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.Oqu(t.getProductCatalogsSelectedLength())}}const R=o=>({portrait:o}),T=(o,c)=>({small:o,disabled:c});function W(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"div",32)(1,"div",33)(2,"ion-button",34),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.setCounterPage(1))}),e._uU(3," Proveedor "),e.YNc(4,G,1,2,"ion-icon",35)(5,z,2,1,"ion-badge",7),e.qZA()(),e.TgZ(6,"ion-button",36),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.setCounterPage(2))}),e._uU(7," Clientes "),e.YNc(8,V,1,2,"ion-icon",35)(9,j,2,1,"ion-badge",7),e.qZA(),e.TgZ(10,"ion-button",37),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.setCounterPage(3))}),e._uU(11," Categor\xeda "),e.YNc(12,B,1,2,"ion-icon",35)(13,$,2,1,"ion-badge",7),e.qZA(),e.TgZ(14,"ion-button",38),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.setCounterPage(4))}),e._uU(15," Formulario "),e._UZ(16,"ion-icon",39),e.qZA()()}if(2&o){const t=e.oxw();e.Q6J("ngClass",e.VKq(19,R,!t.isLandscape)),e.xp6(2),e.Q6J("color",t.getProviderListSelectedLength()>0||1==t.counter&&!t.showDangerTab1?"primary":t.showDangerTab1?"danger":"medium")("fill",t.getProviderListSelectedLength()>0?"solid":"outline")("ngClass",e.WLB(21,T,!t.isLandscape,0==t.getProviderListSelectedLength())),e.xp6(2),e.Q6J("ngIf",t.getProviderListSelectedLength()<=0&&t.showDangerTab1),e.xp6(1),e.Q6J("ngIf",t.getProviderListSelectedLength()>0),e.xp6(1),e.Q6J("color",t.getClientsSelectedLength()>0||2==t.counter&&!t.showDangerTab2?"primary":t.showDangerTab2?"danger":"medium")("fill",t.getClientsSelectedLength()>0?"solid":"outline")("ngClass",e.WLB(24,T,!t.isLandscape,0==t.getClientsSelectedLength())),e.xp6(2),e.Q6J("ngIf",t.getClientsSelectedLength()<=0&&t.showDangerTab2),e.xp6(1),e.Q6J("ngIf",t.getClientsSelectedLength()>0),e.xp6(1),e.Q6J("color",t.getProductCatalogsSelectedLength()>0||3==t.counter&&!t.showDangerTab3?"primary":t.showDangerTab3?"danger":"medium")("fill",t.getProductCatalogsSelectedLength()>0?"solid":"outline")("ngClass",e.WLB(27,T,!t.isLandscape,0==t.getProductCatalogsSelectedLength())),e.xp6(2),e.Q6J("ngIf",t.getProductCatalogsSelectedLength()<=0&&t.showDangerTab3),e.xp6(1),e.Q6J("ngIf",t.getProductCatalogsSelectedLength()>0),e.xp6(1),e.Q6J("color",t.getProductCatalogsSelectedLength()>0&&t.getClientsSelectedLength()>0&&t.getProviderListSelectedLength()>0||4==t.counter?"primary":"medium")("fill",4==t.counter?"solid":"outline")("ngClass",e.WLB(30,T,!t.isLandscape,4!==t.counter))}}function X(o,c){1&o&&e._UZ(0,"ion-skeleton-text",41),2&o&&e.Q6J("animated",!0)}const ee=o=>({highlight:o});function te(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"div",42),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onPrevious())}),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("ngClass",e.VKq(1,ee,t.isPreviousHighlighted))}}const ie=(o,c)=>({"pagination-site-next-landscape":o,highlight:c});function ne(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"div",43),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.onNext())}),e.qZA()}if(2&o){const t=e.oxw();e.Q6J("ngClass",e.WLB(1,ie,t.isLandscape,t.isNextHighlighted))}}function oe(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"ion-datetime",57),e.NdJ("ionChange",function(n){e.CHM(t);const r=e.oxw(3);return e.KtG(r.changeDateTransaction(n))}),e.qZA()}if(2&o){const t=e.oxw(3);e.Q6J("value",t.transactionDate)}}const re=o=>({select:o});function se(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"ion-item",60),e.NdJ("click",function(){const r=e.CHM(t).$implicit,a=e.oxw(4);return e.KtG(a.selectProvider(r))}),e._uU(1),e.qZA()}if(2&o){const t=c.$implicit,i=e.oxw(4);e.Q6J("ngClass",e.VKq(2,re,i.providersIdsSelected.includes(t.id))),e.xp6(1),e.Oqu(t.name)}}function ce(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"ion-list")(1,"ion-searchbar",58),e.NdJ("ionInput",function(n){e.CHM(t);const r=e.oxw(3);return e.KtG(r.findProviders(n))}),e.qZA(),e.YNc(2,se,2,4,"ion-item",59),e.qZA()}if(2&o){const t=e.oxw(3);e.xp6(2),e.Q6J("ngForOf",t._providersFilter)}}function ae(o,c){1&o&&(e.TgZ(0,"ion-list"),e._UZ(1,"ion-skeleton-text",61)(2,"ion-skeleton-text",61)(3,"ion-skeleton-text",61),e.qZA()),2&o&&(e.xp6(1),e.Q6J("animated",!0),e.xp6(1),e.Q6J("animated",!0),e.xp6(1),e.Q6J("animated",!0))}const le=(o,c)=>({"padding-top-0":o,"margin-top-0":c});function de(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"section",47)(1,"h2"),e._uU(2,"Paso 1 "),e.TgZ(3,"small"),e._uU(4,"Seleccione el provedor"),e.qZA()(),e.TgZ(5,"ion-grid",48)(6,"ion-row")(7,"ion-col",49)(8,"h6"),e._uU(9,"Fecha de Transacci\xf3n"),e.qZA(),e.TgZ(10,"div",33),e._UZ(11,"ion-datetime-button",50)(12,"ion-icon",51),e.TgZ(13,"ion-modal",52),e.YNc(14,oe,1,1,"ng-template"),e.qZA()(),e.TgZ(15,"div",53),e._uU(16,"Detalle del viaje"),e.qZA(),e.TgZ(17,"ion-textarea",54),e.NdJ("ionInput",function(){e.CHM(t);const n=e.oxw(2);return e.KtG(n.saveCurrentDelivery())})("ngModelChange",function(n){e.CHM(t);const r=e.oxw(2);return e.KtG(r.description=n)}),e.qZA()(),e.TgZ(18,"ion-col",55),e.YNc(19,ce,3,1,"ion-list",56)(20,ae,4,3,"ion-list",56),e.qZA()()()()}if(2&o){const t=e.oxw(2);e.Q6J("ngClass",e.WLB(7,le,!t.isLandscape,!t.isLandscape)),e.xp6(7),e.Q6J("size",t.isLandscape?6:12),e.xp6(6),e.Q6J("keepContentsMounted",!0),e.xp6(4),e.Q6J("ngModel",t.description),e.xp6(1),e.Q6J("size",t.isLandscape?6:12),e.xp6(1),e.Q6J("ngIf",t.providers.length>0),e.xp6(1),e.Q6J("ngIf",0==t.providers.length)}}function _e(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"div",69),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(4);return e.KtG(n.toogleClients(!0))}),e.qZA()}}function ge(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"div",70),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(4);return e.KtG(n.toogleClients(!1))}),e._UZ(1,"ion-icon",71),e.qZA()}}function ue(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"div",72),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(4);return e.KtG(n.toogleClients(!0))}),e._UZ(1,"div",73),e.qZA()}}function pe(o,c){if(1&o&&(e.TgZ(0,"ion-buttons",2),e.YNc(1,_e,1,0,"div",66)(2,ge,2,0,"div",67)(3,ue,2,0,"div",68),e.qZA()),2&o){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",t.isAllClearClient()),e.xp6(1),e.Q6J("ngIf",t.isAllSelectedClient()),e.xp6(1),e.Q6J("ngIf",t.isPartialSelectedClient())}}function he(o,c){1&o&&(e.TgZ(0,"ion-buttons",2),e._UZ(1,"div",74),e.qZA())}function fe(o,c){1&o&&(e.TgZ(0,"div",80),e._UZ(1,"ion-icon",71),e.qZA())}function ve(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"ion-col",55)(1,"ion-row",75),e.NdJ("click",function(){const r=e.CHM(t).$implicit,a=e.oxw(3);return e.KtG(a.selectClient(r.client,!0))}),e.TgZ(2,"ion-col",76),e._UZ(3,"div",77),e.YNc(4,fe,2,0,"div",78),e.qZA(),e.TgZ(5,"ion-col",79),e._uU(6),e.qZA()()()}if(2&o){const t=c.$implicit,i=e.oxw(3);e.Q6J("size",i.isLandscape?6:12),e.xp6(3),e.Q6J("hidden",t.selected),e.xp6(1),e.Q6J("ngIf",t.selected),e.xp6(2),e.hij(" ",t.client.name," ")}}function me(o,c){1&o&&(e.TgZ(0,"ion-col"),e._uU(1," No hay resultados para esta consulta "),e.qZA())}function Ce(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"section",62)(1,"h2"),e._uU(2,"Paso 2"),e.TgZ(3,"small"),e._uU(4,"Seleccione los clientes"),e.qZA()(),e.TgZ(5,"ion-list")(6,"ion-item"),e.YNc(7,pe,4,3,"ion-buttons",63)(8,he,2,0,"ion-buttons",63),e.TgZ(9,"ion-searchbar",64),e.NdJ("ionInput",function(n){e.CHM(t);const r=e.oxw(2);return e.KtG(r.findClient(n))}),e.qZA()(),e.TgZ(10,"ion-grid")(11,"ion-row"),e.YNc(12,ve,7,4,"ion-col",65)(13,me,2,0,"ion-col",56),e.qZA()()()()}if(2&o){const t=e.oxw(2);e.xp6(7),e.Q6J("ngIf",t._clientsFilter.length>0),e.xp6(1),e.Q6J("ngIf",0==t._clientsFilter.length),e.xp6(4),e.Q6J("ngForOf",t._clientsFilter),e.xp6(1),e.Q6J("ngIf",0==t._clientsFilter.length)}}function xe(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"div",69),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(3);return e.KtG(n.toogleProductCatalogList(!0))}),e.qZA()}}function Pe(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"div",70),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(3);return e.KtG(n.toogleProductCatalogList(!1))}),e._UZ(1,"ion-icon",71),e.qZA()}}function be(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"div",72),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(3);return e.KtG(n.toogleProductCatalogList(!0))}),e._UZ(1,"div",88),e.qZA()}}function ye(o,c){1&o&&(e.TgZ(0,"div",80),e._UZ(1,"ion-icon",71),e.qZA())}function Te(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"ion-row")(1,"ion-col",89),e.NdJ("click",function(){const r=e.CHM(t).$implicit,a=e.oxw(3);return e.KtG(a.selectProductCatalog(r.productCatalog,!1))}),e._UZ(2,"div",77),e.YNc(3,ye,2,0,"div",78),e.qZA(),e.TgZ(4,"ion-col",86),e._uU(5),e.qZA(),e.TgZ(6,"ion-col",86)(7,"input",90),e.NdJ("ngModelChange",function(n){const a=e.CHM(t).$implicit;return e.KtG(a.productCatalog.price=n)})("keyup",function(){e.CHM(t);const n=e.oxw(3);return e.KtG(n.productCatalogChance())}),e.qZA()()()}if(2&o){const t=c.$implicit,i=e.oxw(3);e.xp6(2),e.Q6J("hidden",i.findProductInList(t.productCatalog)),e.xp6(1),e.Q6J("ngIf",i.findProductInList(t.productCatalog)),e.xp6(2),e.Oqu(t.productCatalog.name),e.xp6(2),e.Q6J("ngModel",t.productCatalog.price)}}const De=o=>({"padding-3":o});function we(o,c){if(1&o&&(e.TgZ(0,"section",62)(1,"h2",81),e._uU(2,"Paso 3 "),e.TgZ(3,"small"),e._uU(4,"Seleccione las categor\xedas"),e.qZA()(),e.TgZ(5,"ion-grid",82)(6,"ion-row",83)(7,"ion-col",84),e.YNc(8,xe,1,0,"div",66)(9,Pe,2,0,"div",67)(10,be,2,0,"div",68),e.qZA(),e.TgZ(11,"ion-col",85),e._uU(12,"Calidad"),e.qZA(),e.TgZ(13,"ion-col",86),e._uU(14,"Precio x Unidad"),e.qZA()(),e.YNc(15,Te,8,4,"ion-row",87),e.qZA()()),2&o){const t=e.oxw(2);e.xp6(5),e.Q6J("ngClass",e.VKq(5,De,t.isLandscape)),e.xp6(3),e.Q6J("ngIf",t.isAllClearProductCatalog()),e.xp6(1),e.Q6J("ngIf",t.isAllSelectedProductCatalog()),e.xp6(1),e.Q6J("ngIf",t.isPartialSelectedProductCatalog()),e.xp6(5),e.Q6J("ngForOf",t.productCatalogsCss)}}function Me(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"ion-datetime",57),e.NdJ("ionChange",function(n){e.CHM(t);const r=e.oxw(3);return e.KtG(r.changeDateTransaction(n))}),e.qZA()}if(2&o){const t=e.oxw(3);e.Q6J("value",t.transactionDate)}}function Ze(o,c){if(1&o&&(e.TgZ(0,"small"),e._uU(1),e.qZA()),2&o){const t=e.oxw(3);e.xp6(1),e.AsE(" Total Unidades ",t.getTotalDeliveryUnits()," ",t.getTotalDeliveryUnits()>1?"unidades":"unidad"," ")}}const Oe=o=>({height:o});function Ie(o,c){if(1&o&&e._UZ(0,"div",108),2&o){const t=e.oxw(2).$implicit,i=e.oxw(3);e.Q6J("ngStyle",e.VKq(1,Oe,2.2*i.lengthProduct(t)+"rem"))}}const Se=o=>({small:o});function ke(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"ion-row",101)(1,"ion-col",102)(2,"span",103),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(),r=n.$implicit,a=n.index,s=e.oxw(3);return e.KtG(s.toogleListClientInProductCatalog(r,a))}),e._uU(3),e.qZA(),e.YNc(4,Ie,1,3,"div",104),e._uU(5),e.qZA(),e.TgZ(6,"ion-col",105),e._uU(7),e.qZA(),e._UZ(8,"ion-col",106),e.TgZ(9,"ion-col",107),e._uU(10),e.ALo(11,"COP"),e.qZA()()}if(2&o){const t=e.oxw().$implicit,i=e.oxw(3);e.xp6(1),e.MGl("id","table-item-id-",t.productCatalog.id,""),e.xp6(1),e.Q6J("ngClass",e.VKq(9,Se,i.showClientInItem)),e.xp6(1),e.Oqu(i.showClientInItem?"-":"+"),e.xp6(1),e.Q6J("ngIf",i.showClientInItem),e.xp6(1),e.hij(" ",t.productCatalog.name," "),e.xp6(2),e.Oqu(i.getTotalProductCatalogUnits(t)),e.xp6(3),e.hij("",e.lcZ(11,7,i.getTotalProductCatalogPrice(t))," ")}}const S=o=>({"input-trx-price":o});function Ae(o,c){if(1&o){const t=e.EpF();e.TgZ(0,"ion-row",110)(1,"ion-col",111),e._uU(2),e.qZA(),e.TgZ(3,"ion-col",112)(4,"input",113),e.NdJ("ngModelChange",function(n){e.CHM(t);const r=e.oxw().$implicit;return e.KtG(r.unit=n)})("focus",function(){e.CHM(t);const n=e.oxw().$implicit;return e.KtG(0==n.unit?n.unit=void 0:n.unit)})("keyup",function(n){e.CHM(t);const r=e.oxw().$implicit,a=e.oxw(4);return e.KtG(a.onInputUnit(r,n))}),e.qZA()(),e.TgZ(5,"ion-col",114)(6,"input",115),e.NdJ("ngModelChange",function(n){e.CHM(t);const r=e.oxw().$implicit;return e.KtG(r.price=n)})("keyup",function(n){e.CHM(t);const r=e.oxw().$implicit,a=e.oxw(4);return e.KtG(a.onInputPrice(r,n))}),e.qZA()(),e.TgZ(7,"ion-col",107),e._uU(8),e.ALo(9,"COP"),e.qZA()()}if(2&o){const t=e.oxw().$implicit,i=e.oxw().$implicit,n=e.oxw(3);e.xp6(2),e.Oqu(t.client.name),e.xp6(2),e.Q6J("ngModel",t.unit)("ngClass",e.VKq(9,S,t.unit&&t.unit>0)),e.xp6(2),e.Q6J("ngModel",t.price)("placeholder",n.formatPrice(i.productCatalog.price))("ngClass",e.VKq(11,S,(null==t?null:t.price)||!1)),e.xp6(2),e.Oqu(e.lcZ(9,7,(t.unit?t.unit:0)*(t.price?t.price:i.productCatalog.price?i.productCatalog.price:0)))}}function Je(o,c){if(1&o&&(e.ynx(0),e.YNc(1,Ae,10,13,"ion-row",109),e.BQk()),2&o){const t=c.$implicit,i=e.oxw().$implicit,n=e.oxw(3);e.xp6(1),e.Q6J("ngIf",i.selected&&t.selected&&(n.showClientInItem||t.unit&&t.unit>0))}}function qe(o,c){if(1&o&&(e.ynx(0),e.YNc(1,ke,12,11,"ion-row",100)(2,Je,2,1,"ng-container",87),e.BQk()),2&o){const t=c.$implicit;e.xp6(1),e.Q6J("ngIf",t.selected),e.xp6(1),e.Q6J("ngForOf",t.clientProductsCss)}}const Ne=o=>({opacity:o});function Le(o,c){if(1&o&&(e.TgZ(0,"section",91)(1,"div",92)(2,"h4"),e._uU(3),e.qZA(),e.TgZ(4,"h6",93),e._uU(5," Fecha de transacci\xf3n:"),e.qZA(),e.TgZ(6,"div",94),e._UZ(7,"ion-datetime-button",50)(8,"ion-icon",51),e.TgZ(9,"ion-modal",52),e.YNc(10,Me,1,1,"ng-template"),e.qZA()(),e.TgZ(11,"small"),e._uU(12),e.qZA(),e.TgZ(13,"div")(14,"h5",95),e._uU(15),e.ALo(16,"COP"),e.qZA(),e.YNc(17,Ze,2,2,"small",56),e.qZA()(),e._UZ(18,"br"),e.TgZ(19,"ion-grid",96)(20,"ion-row",97)(21,"ion-col",98),e._uU(22,"Calidad"),e.qZA(),e.TgZ(23,"ion-col",84),e._uU(24,"Unidades"),e.qZA(),e.TgZ(25,"ion-col",76),e._uU(26,"Valor Unidad"),e.qZA(),e.TgZ(27,"ion-col",99),e._uU(28,"Total Viaje"),e.qZA()(),e.YNc(29,qe,3,2,"ng-container",87),e.qZA()()),2&o){const t=e.oxw(2);e.xp6(3),e.hij(" Viaje ",t.getProviderSelectName()," "),e.xp6(6),e.Q6J("keepContentsMounted",!0),e.xp6(3),e.hij(" ",t.description," "),e.xp6(2),e.Q6J("ngStyle",e.VKq(9,Ne,t.getTotalDeliveryPrice()>0?1:0)),e.xp6(1),e.hij(" Total Viaje ",e.lcZ(16,7,t.getTotalDeliveryPrice())," "),e.xp6(2),e.Q6J("ngIf",t.getTotalDeliveryUnits()>0),e.xp6(12),e.Q6J("ngForOf",t.productCatalogsCss)}}const Qe=o=>({"margin-top-5":o});function Ue(o,c){if(1&o&&(e.TgZ(0,"div",4),e.YNc(1,de,21,10,"section",44)(2,Ce,14,4,"section",45)(3,we,16,7,"section",45)(4,Le,30,11,"section",46),e.qZA()),2&o){const t=e.oxw();e.Q6J("@animImageSlider",t.counter)("ngClass",e.VKq(6,Qe,!t.isLandscape)),e.xp6(1),e.Q6J("ngIf",1===t.counter),e.xp6(1),e.Q6J("ngIf",2===t.counter),e.xp6(1),e.Q6J("ngIf",3===t.counter),e.xp6(1),e.Q6J("ngIf",4===t.counter)}}function Fe(o,c){1&o&&e._UZ(0,"ion-skeleton-text",116),2&o&&e.Q6J("animated",!0)}function Ye(o,c){1&o&&e._UZ(0,"ion-skeleton-text",41),2&o&&e.Q6J("animated",!0)}const He=(o,c)=>({"ion-text-start":o,"padding-left-3":c}),Ee=[{path:"",component:(()=>{class o{constructor(t,i,n,r,a,s,l,d,_,h){this.gestureCtrl=t,this.cdRef=i,this.dialog=n,this.screenSizeService=r,this.dialogService=a,this.storageService=s,this.redirectService=l,this.activatedRoute=d,this.apiService=_,this.deliveryServices=h,this.counter=1,this._clientsFilter=[],this.clients=[],this.clientsTotal=-1,this.providers=[],this._providersFilter=[],this.productCatalogsCss=[],this.validate=!1,this.transactionDate=C().format("YYYY-MM-DD"),this.description="",this.showClientInItem=!0,this.isCardActive=!1,this.isNextHighlighted=!1,this.isPreviousHighlighted=!1,this.providersIdsSelected=[],this.showDangerTab1=!1,this.showDangerTab2=!1,this.showDangerTab3=!1,this.loaded=!1,this.deliveryId=(new Date).getTime(),this.isNew=!0,this.hasChanged=!1,this.isOpen=!1}ionViewDidEnter(){this.redirectService.routerNameChange("tabs/delivery"),this.initialize()}initialize(){var t=this;return(0,u.Z)(function*(){t.counter=1,t._clientsFilter=[],t.clients=[],t.clientsTotal=-1,t.providers=[],t._providersFilter=[],t.productCatalogsCss=[],t.validate=!1,t.transactionDate=C().format("YYYY-MM-DD"),t.description="",t.showClientInItem=!0,t.isCardActive=!1,t.isNextHighlighted=!1,t.isPreviousHighlighted=!1,t.providersIdsSelected=[],t.showDangerTab1=!1,t.showDangerTab2=!1,t.showDangerTab3=!1,t.transactionsOri=[],t.deliveriesOri=[],t.deliveryId=(new Date).getTime(),t.isNew=!0,t.hasChanged=!1,t.loaded=!1,t.setupGestures();const i=yield t.dialogService.showLoading();t.isLandscape=t.screenSizeService.isLandscape,t.isSmallScreen=t.screenSizeService.isSmallScreen,t.screenSizeService.isLandscape$.subscribe(n=>{t.isLandscape=n.isLandscape,t.isSmallScreen=n.isSmallScreen}),t.userAuth=yield t.storageService.getUserAuth(),t.activatedRoute.queryParams.subscribe(function(){var n=(0,u.Z)(function*(r){let a;const s=yield r.deliveryId;if(s){const l=yield t.getDeliveryById(Number(s));if(l){t.deliveryId=s,t.isNew=!1,a=l.transaction_type_id,C(l.date,"YYYY-MM-DD",!0).isValid()&&(t.transactionDate=C(l.date,"YYYY-MM-DD",!0).format("YYYY-MM-DD"));const d=yield t.storageService.getTransactions(t.userAuth);t.transactionsOri=d?.filter(_=>Number(_.delivery_id)==Number(t.deliveryId))}else t.exceptionFinish("No se encuentra el c\xf3digo del viaje")}else a=r.typeId,a||t.exceptionFinish("No se encuentra el c\xf3digo de transacci\xf3n");if(yield t.loadTransactionType(a),t.transactionsOri)for(const l of t.productCatalogsCss)for(const d of t.transactionsOri)if(d.transactionsDetails)for(const _ of d.transactionsDetails)if(Number(_.product_catalog_id)==Number(l.productCatalog.id)){l.selected=!0;for(const h of l.clientProductsCss)if(h.client.id==d.client_id){for(let D of t.clients)if(D.client.id==h.client.id){D.selected=!0;break}h.price=_.price,h.unit=_.units,h.selected=!0;break}}t.isNew||t.setCounterPage(4),setTimeout(()=>{t.loaded=!0},1e3),i.dismiss()});return function(r){return n.apply(this,arguments)}}())})()}ionViewWillLeave(){}ionViewDidLeave(){}onNext(){this.isNextHighlighted=!0,setTimeout(()=>{this.isNextHighlighted=!1},400),this.showDangerTab1=!1,this.showDangerTab2=!1,this.showDangerTab3=!1,1==this.counter?this.getProviderListSelectedLength()>0?this.counter++:(this.showDangerTab1=!0,this.dialog.showMessage("Seleccione un proveedor")):2==this.counter?this.getClientsSelectedLength()>0?this.counter++:(this.showDangerTab2=!0,this.dialog.showMessage("Seleccione los clientes")):3==this.counter&&(this.getProductCatalogsSelectedLength()>0?this.counter++:this.showDangerTab3=!0)}onPrevious(){this.isPreviousHighlighted=!0,setTimeout(()=>{this.isPreviousHighlighted=!1},1e3),this.counter>1&&(this.showDangerTab1=!1,this.showDangerTab2=!1,this.showDangerTab3=!1,this.counter--)}setCounterPage(t){var i=this;return(0,u.Z)(function*(){if(t!=i.counter){if(i.showDangerTab1=!1,i.showDangerTab2=!1,i.showDangerTab3=!1,t<i.counter)return void(i.counter=t);if(t>1){if(!(i.getProviderListSelectedLength()>0))return i.counter=1,i.showDangerTab1=!0,void i.dialog.showMessage("Seleccione un proveedor");if(t>2){if(!(i.getClientsSelectedLength()>0))return i.counter=2,i.showDangerTab2=!0,void i.dialog.showMessage("Seleccione los clientes");if(t>3){if(!(i.getProductCatalogsSelectedLength()>0))return i.counter=3,i.showDangerTab3=!0,void i.dialog.showMessage("Seleccione las categor\xedas");if(4==t){const n=yield i.dialogService.showLoading();i.counter=t,setTimeout(()=>{n.dismiss()},1e3)}}}}i.counter=t}})()}changeDateTransaction(t){const i=t.target;if(i){const n=C(t.detail.value);this.transactionDate=n.format("YYYY-MM-DD"),this.saveCurrentDelivery();const r=i.parentNode.parentElement;r&&r.dismiss()}}findClient(t){const i=(t.target.value||"").trim().toLowerCase();this._clientsFilter=i?this._clientsFilter.filter(n=>n.client?.name?.toLowerCase().includes(i)):this.clients,this.clientsTotal=i?this._clientsFilter.length:-1}findProviders(t){const i=(t.target.value||"").trim().toLowerCase();this._providersFilter=i?this.providers.filter(n=>n?.name?.toLowerCase().includes(i)):this.providers}toogleListClientInProductCatalog(t,i){var n=this;return(0,u.Z)(function*(){const r=yield n.dialogService.showLoading();n.showClientInItem=!n.showClientInItem,0!=i?(n.showClientInItem&&(yield n.moveToPoint(1,0)),yield n.moveToPoint(t.productCatalog.id,10),r.dismiss()):r.dismiss()})()}moveToPoint(t,i){const r=document.getElementById(`table-item-id-${t}`),a=document.querySelector("ion-content");if(r&&a){const s=r.getBoundingClientRect().top-a.scrollTop;this.content?.scrollToPoint(0,s,i)}return new Promise((s,l)=>{setTimeout(()=>{s("")},i)})}selectClient(t,i){const n=this.clients.findIndex(r=>r.client.id===t.id);if(-1!==n){this.clients[n].selected=!this.clients[n].selected;const r=this._clientsFilter.findIndex(s=>s.client.id===t.id);-1!==r&&(this._clientsFilter[r].selected=this.clients[n].selected);const a=this.clients[n];for(let s of this.productCatalogsCss){const l=s.clientProductsCss.find(d=>d.client.id===a.client.id);l?l.selected=a.selected:(a.selected=!0,s.clientProductsCss.push({client:a.client,selected:a.selected}))}i&&this.saveCurrentDelivery()}}isPartialSelectedClient(){const t=this._clientsFilter.filter(i=>i.selected).length;return t>=1&&this._clientsFilter.length!=t}isAllSelectedClient(){const t=this._clientsFilter.filter(i=>i.selected).length;return t>=1&&this._clientsFilter.length==t}isAllClearClient(){return 0==this._clientsFilter.filter(i=>i.selected).length}toogleClients(t){this._clientsFilter.filter(i=>i.selected!==t).forEach(i=>this.selectClient(i.client,!1)),this.saveCurrentDelivery()}findProductInList(t){return this.productCatalogsCss.some(i=>i.selected&&i.productCatalog.id===t.id)}selectProductCatalog(t,i){const n=this.productCatalogsCss.findIndex(r=>r.productCatalog.id===t.id);-1!==n&&(this.productCatalogsCss[n].selected=!this.productCatalogsCss[n].selected,i||this.saveCurrentDelivery())}isPartialSelectedProductCatalog(){const t=this.productCatalogsCss.filter(i=>i.selected).length;return t>=1&&this.productCatalogsCss.length!=t}isAllSelectedProductCatalog(){const t=this.productCatalogsCss.filter(i=>i.selected).length;return t>1&&this.productCatalogsCss.length==t}isAllClearProductCatalog(){return 0==this.productCatalogsCss.filter(i=>i.selected).length}toogleProductCatalogList(t){this.productCatalogsCss.forEach(i=>{const n=this.findProductInList(i.productCatalog);(n&&!t||!n&&t)&&this.selectProductCatalog(i.productCatalog,!1)})}selectProvider(t){const i=this.providersIdsSelected.findIndex(n=>n===t.id);-1!==i?(this.providersIdsSelected.splice(i,1),this.saveCurrentDelivery()):(this.providersIdsSelected.push(t.id),this.saveCurrentDelivery()),this.orderProvider()}inputOnchange(t,i){let r=t.currentTarget.value.trim().replace("$","");if(0==r.length)return t.currentTarget.value="",void(this.findProductInList(i)&&this.selectProductCatalog(i,!1));/^[a-zA-Z]$/.test(t.key)&&!["Backspace","Tab"].includes(t.key)&&(console.log(t.key),r=r.substr(0,r.length-1)),t.currentTarget.value=(0,x.gq)(r),this.findProductInList(i)||this.selectProductCatalog(i,!1)}presentOnFinish(){var i,t=this;0==this.getTotalDeliveryPrice()?this.dialogService.showAlert({header:"Finalizar viaje",subHeader:"El Valor del viaje no puede ser 0",buttons:[{text:"Cerrar",cssClass:"alert-medium-confirm",handler:(i=(0,u.Z)(function*(){}),function(){return i.apply(this,arguments)})}]}):4!=this.counter||this.isNew||this.hasChanged?this.dialogService.showAlert({header:"Finalizar viaje",subHeader:"\xbfSeguro que desea guardar los cambios para "+(this.isNew?"este nuevo viaje?":"el viaje?"),message:"Valor del viaje "+(0,x.gq)(this.getTotalDeliveryPrice()),buttons:[{text:"Cancelar",cssClass:"alert-button-cancel",role:"cancel",handler:()=>{}},{text:"Confirmar",cssClass:"alert-success-confirm",handler:function(){var i=(0,u.Z)(function*(){t.onFinish()});return function(){return i.apply(this,arguments)}}()}]}):this.goToDeliveryList()}onFinish(){var t=this;return(0,u.Z)(function*(){if(!t.userAuth)return;const i=yield t.dialogService.showLoading(),n=t.makeDelivery(),r=n.transactions,a=n.id;let s=yield t.apiService.saveDelivery([n]).catch(f=>{});if(s){const f=s["saveDelivery-"+a],b=f.insert||f.update;if(n.id=Number(b.id),delete n.transactions,yield t.storageService.pushDelivery(t.userAuth,n,a),r)for(let v of r){const Z=v.id;if(b.transactions["savetx-"+Z]){const O=b.transactions["savetx-"+Z];v.id=Number(O.insert?O.insert.id:O.update.id),v.delivery_id=n.id,yield t.storageService.pushTransactions(t.userAuth,v,Z)}}}else if(delete n.transactions,n.syncRequired=!0,yield t.storageService.pushDelivery(t.userAuth,n,a),r)for(let f of r)f.syncRequired=!0,yield t.storageService.pushTransactions(t.userAuth,f,f.id);const l={};if(r){let f=0;for(const b of r){const v=b.client_id+"";l[v]||(f++,console.log(f),l[v]=!0,t.deliveryServices.orderClientTransactions(t.userAuth,b.client_id))}}const d=yield t.storageService.getVersion(t.userAuth);d.version++,yield t.apiService.saveVersion(t.userAuth,d).catch(f=>{}),yield t.storageService.setVersion(t.userAuth,d),i.dismiss(),yield t.storageService.removeCurrentDelivery(t.userAuth),t.goToDeliveryList();const h="Viaje "+(t.isNew?"creado":"modificado")+" exit\xf3samente",D=yield t.dialogService.showAlert({subHeader:h,buttons:[{text:"Volver",cssClass:"alert-success-confirm",role:"cancel",handler:()=>{t.goToDeliveryList()}}]});setTimeout(()=>{D.dismiss()},2e3)})()}makeDelivery(){const t=[];let i,n=0;for(let a of this.productCatalogsCss)if(a.selected)for(let s of a.clientProductsCss)if(n++,s.selected&&s.unit&&s.unit>0){const l=t.findIndex(_=>Number(_.client_id)==Number(s.client.id));let d=(s.price||a.productCatalog.price||0)*s.unit;if(-1===l){let _=(new Date).getTime()+n;this.isNew||(_=this.findTransactionByClient(this.deliveryId,s.client.id,a.productCatalog.id)),i={date:this.transactionDate,price:d,units:s.unit,balanceAfter:(s.client?.balance||0)+d,balanceBefore:s.client?.balance||0,transaction_type_id:this.transactionType.id,client_id:s.client.id,transactionsDetails:[],syncRequired:!0,delivery_id:this.deliveryId,user_id:this.userAuth?this.userAuth.id:0,id:_},t.push(i)}else i=t[l],i.price+=d,i.units+=s.unit;if(i.transactionsDetails){const _=i.transactionsDetails.length+1;i.transactionsDetails?.push({sequence:_,product_catalog_id:a.productCatalog.id,price:s.price||a.productCatalog.price||0,units:s.unit})}}return{id:this.deliveryId,date:this.transactionDate,description:this.description,user_id:this.userAuth?this.userAuth.id:0,transaction_type_id:this.transactionType.id,total_price:this.getTotalDeliveryPrice(),total_units:this.getTotalDeliveryUnits(),transactions:t,provider_ids:JSON.stringify(this.providersIdsSelected),syncRequired:!0}}findTransactionByClient(t,i,n){const r=this.transactionsOri?.filter(a=>a.client_id==i&&a.transactionsDetails?.some(s=>s.product_catalog_id==n));return 1==r?.length?r[0].id:(new Date).getTime()+t+i+n}getClientInTransactions(t,i){return t.find(n=>n.client?.id==i)}goToDeliveryList(){var t=this;return(0,u.Z)(function*(){t.redirectService.redirectTo("/tabs/tab2",{noLoad:!0})})()}setupGestures(){const t=document.querySelector(".container-sliders");t&&this.gestureCtrl.create({el:t,onStart:()=>{this.isCardActive=!0,this.cdRef.detectChanges()},onMove:n=>{const{type:r,currentX:a,deltaX:s,velocityX:l}=n;this.debug&&(this.debug.nativeElement.innerHTML=`\n            <div>Type: ${r}</div>\n            <div>Current X: ${a}</div>\n            <div>Delta X: ${s}</div>\n            <div>Velocity X: ${l}</div>`)},onEnd:n=>{this.isCardActive=!1,this.cdRef.detectChanges(),n.deltaX>125?this.onPrevious():n.deltaX<-125&&this.onNext()},gestureName:"swipe"}).enable()}lock(){return(0,u.Z)(function*(){})()}lockPortrait(){return(0,u.Z)(function*(){})()}unlock(){return(0,u.Z)(function*(){})()}getCurrentOrientation(){return(0,u.Z)(function*(){})()}getTotalDeliveryPrice(){let t=0;for(let i of this.productCatalogsCss)i.selected&&(t+=this.getTotalProductCatalogPrice(i));return t}getTotalDeliveryUnits(){let t=0;for(let i of this.productCatalogsCss)t+=this.getTotalProductCatalogUnits(i);return t}getTotalProductCatalogUnits(t){let i=0;for(let n of t.clientProductsCss)i+=n.unit||0;return i}getTotalProductCatalogPrice(t){let i=0;for(let n of t.clientProductsCss)n.selected&&(i+=(n.unit||0)*(n.price||t.productCatalog.price||0));return i}getProviderListSelectedLength(){return this.providersIdsSelected?this.providersIdsSelected.length:0}getProductCatalogsSelectedLength(){return this.productCatalogsCss.filter(t=>t.selected).length}getClientsSelectedLength(){return this.clients.filter(t=>t.selected).length}formatPrice(t){return(0,x.gq)(t)}getProviderSelectName(){return this.providers.filter(i=>this.providersIdsSelected.includes(i.id)).map(i=>i.name).join(" - ")}saveCurrentDelivery(){this.hasChanged=!0}productCatalogChance(){this.saveCurrentDelivery()}onInputUnit(t,i){this.saveCurrentDelivery()}onInputPrice(t,i){this.saveCurrentDelivery()}getDeliveryOnCache(t){var i=this;return(0,u.Z)(function*(){const n=yield i.dialogService.showLoading();try{i.deliveryId=t.deliveryId,i.clients=t.clients.map(r=>({...r})),i.productCatalogsCss=t.productCatalogs.map(r=>({...r})),i.transactionDate=t.transactionDate,i.providersIdsSelected=t.provider_ids||[]}catch(r){i.dialogService.showMessage(JSON.stringify(r))}n.dismiss(),i.counter=1})()}getDeliveryById(t){var i=this;return(0,u.Z)(function*(){const n=yield i.dialogService.showLoading();i.deliveriesOri=yield i.storageService.getDeliveries(i.userAuth);const r=i.deliveriesOri?.find(a=>a.id==t);if(r){i.deliveryId=r.id,i.clients.filter(s=>r.transactions?.some(l=>l.client_id===s.client.id)).forEach(s=>s.selected=!0),i.productCatalogsCss.forEach(s=>{if(r.transactions){for(let l of r.transactions)if(l.transactionsDetails)for(let d of l.transactionsDetails)if(d.product_catalog_id==s.productCatalog.id)for(let _ of s.clientProductsCss)_.client.id==l.client_id&&(_.price=Number(d.price),_.unit=Number(d.units),_.selected=!0);r.transactions.some(l=>l.transactionsDetails?.some(d=>d.product_catalog_id===s.productCatalog.id))&&(s.selected=!0)}});const a=yield i.storageService.getTransactionTypes(i.userAuth);i.transactionType=a?.find(s=>s.id==r.transaction_type_id),i.transactionDate=r.date,i.description=r.description,i.providersIdsSelected=JSON.parse(r.provider_ids),i.counter=1,i.orderProvider()}return n.dismiss(),r})()}lengthProduct(t){return t.clientProductsCss.filter(i=>i.selected).length}orderProvider(){this._providersFilter.sort((t,i)=>(this.providersIdsSelected.includes(t.id),this.providersIdsSelected.includes(i.id)?1:-1))}loadTransactionType(t){var i=this;return(0,u.Z)(function*(){i.providers=yield i.storageService.getProviders(i.userAuth),i._providersFilter=i.providers;const n=yield i.storageService.getClients(i.userAuth);if(i.clients=n.map(r=>({client:r,selected:!1})),i._clientsFilter=i.clients,t){const r=yield i.storageService.getTransactionTypes(i.userAuth);i.transactionType=r?.find(a=>a.id==Number(t)&&a.targetType==x.Lm.Credit)}if(i.transactionType){const a=(yield i.storageService.getProductCatalogs(i.userAuth)).filter(s=>s.transaction_type_id==t);i.productCatalogsCss=a.map(s=>({productCatalog:s,clientProductsCss:i.clients.map(l=>({client:l.client,selected:!1})),selected:!1,price:s.price||0}))}else i.exceptionFinish("No se encuentra el tipo de transacci\xf3n")})()}presentPopoverAction(t){this.popoverAction&&(this.popoverAction.event=t),this.isOpen=!0}closePopover(){this.popoverAction&&this.popoverAction.dismiss()}presentClearCurrent(){var i,t=this;this.closePopover(),this.dialogService.showAlert({header:"Nuevo Viaje",subHeader:"\xbfSeguro que desea limpiar los datos del formulario?",buttons:[{text:"Cancelar",cssClass:"alert-button-cancel",role:"cancel",handler:()=>{}},{text:"Borrar",cssClass:"alert-delete-confirm",handler:(i=(0,u.Z)(function*(){t.deliveryId=(new Date).getTime(),t.description="",t.transactionDate=C().format("YYYY-MM-DD"),t.providers=yield t.storageService.getProviders(t.userAuth),t._providersFilter=t.providers,t.providersIdsSelected=[],t.transactionType&&(yield t.loadTransactionType(t.transactionType.id)),yield t.storageService.removeCurrentDelivery(t.userAuth),t.onPrevious(),t.onPrevious(),t.onPrevious()}),function(){return i.apply(this,arguments)})}]})}presentDeleteDelivery(){var i,t=this;this.closePopover(),this.dialogService.showAlert({header:"Borrar viaje",subHeader:"\xbfSeguro que desea eliminar este viaje?",message:"Valor del viaje "+(0,x.gq)(this.getTotalDeliveryPrice()),buttons:[{text:"Cancelar",cssClass:"alert-button-cancel",role:"cancel",handler:()=>{}},{text:"Borrar",cssClass:"alert-delete-confirm",handler:(i=(0,u.Z)(function*(){t.deleteDelivery()}),function(){return i.apply(this,arguments)})}]})}deleteDelivery(){var t=this;return(0,u.Z)(function*(){const i=yield t.dialogService.showLoading(),n=yield t.apiService.deleteDelivery([t.deliveryId]).catch(function(){var s=(0,u.Z)(function*(l){t.dialogService.showMessage(l)});return function(l){return s.apply(this,arguments)}}());let r;if(n){const s=yield t.storageService.getTransactions(t.userAuth);if(s){const _=s.filter(h=>h.delivery_id!=t.deliveryId);yield t.storageService.setTransactions(t.userAuth,_)}const l=yield t.storageService.getDeliveries(t.userAuth);if(l){const _=l.findIndex(h=>h.id==t.deliveryId);-1!=_&&(r=l[_],l?.splice(_,1)),yield t.storageService.setDeliveries(t.userAuth,l)}t.goToDeliveryList(),t.dialogService.showAlert({subHeader:"Viaje borrado exit\xf3samente",buttons:[{text:"Volver",cssClass:"alert-button-cancel",role:"cancel",handler:()=>{}}]})}else{const s=yield t.storageService.getTransactions(t.userAuth);if(s){const d=s.filter(_=>_.delivery_id!=t.deliveryId);yield t.storageService.setTransactions(t.userAuth,d)}const l=yield t.storageService.getDeliveries(t.userAuth);if(l){const d=l.findIndex(_=>_.id==t.deliveryId);-1!=d&&(l[d].syncRequired=!0,l[d].total_price=0,l[d].total_units=0,l[d].transactions=void 0),yield t.storageService.setDeliveries(t.userAuth,l)}}const a={};if(r&&r.transactions)for(const s of r.transactions){const l=s.client_id+"";a[l]||(a[l]=!0,yield t.deliveryServices.orderClientTransactions(t.userAuth,s.client_id))}i.dismiss()})()}exceptionFinish(t){this.loaded=!0,this.dialogService.showAlert({subHeader:t,buttons:[{text:"Volver",cssClass:"alert-button-cancel",role:"cancel",handler:()=>{this.goToDeliveryList()}}]})}static#e=this.\u0275fac=function(i){return new(i||o)(e.Y36(g.TH),e.Y36(e.sBO),e.Y36(P.xA),e.Y36(P.O6),e.Y36(P.xA),e.Y36(P.V1),e.Y36(k.V),e.Y36(w.gz),e.Y36(P.sM),e.Y36(P.pN))};static#t=this.\u0275cmp=e.Xpm({type:o,selectors:[["app-delivery"]],viewQuery:function(i,n){if(1&i&&(e.Gf(g.W2,5),e.Gf(J,5,e.SBq),e.Gf(q,5)),2&i){let r;e.iGM(r=e.CRH())&&(n.content=r.first),e.iGM(r=e.CRH())&&(n.debug=r.first),e.iGM(r=e.CRH())&&(n.popoverAction=r.first)}},decls:17,vars:18,consts:[[3,"translucent"],[1,"ion-padding-landscape-head"],["slot","start"],["text","","icon","caret-back","defaultHref","tabs/tab2"],[3,"ngClass"],["class","title-float",4,"ngIf"],["style","width: 100%; height: 100%;",3,"animated",4,"ngIf"],["slot","end",4,"ngIf"],["color","light",1,"ion-padding",3,"fullscreen"],[1,"container-sliders","ion-padding-landscape"],["class","cd-container",3,"ngClass",4,"ngIf"],["style","width: 100%; height: 10rem;",3,"animated",4,"ngIf"],["class","pagination-site-back",3,"ngClass","click",4,"ngIf"],["class","pagination-site-next",3,"ngClass","click",4,"ngIf"],[3,"ngClass",4,"ngIf"],["style","width: 100%; height: 400rem;",3,"animated",4,"ngIf"],[1,"title-float"],[1,"price-float"],[2,"width","100%","height","100%",3,"animated"],["slot","end"],["size","small",3,"click",4,"ngIf"],["size","small","fill","solid","color","primary",3,"disabled","click",4,"ngIf"],["color","primary","fill","clear","size","small",3,"click"],["slot","icon-only","name","ellipsis-vertical-outline"],[3,"isOpen","didDismiss"],["popoverAction",""],["size","small",3,"click"],["name","chevron-back-outline"],["name","chevron-forward-outline"],["size","small","fill","solid","color","primary",3,"disabled","click"],["class","ion-padding",3,"click",4,"ngIf"],[1,"ion-padding",3,"click"],[1,"cd-container",3,"ngClass"],[1,"display-flex"],["shape","round",1,"button-section","btn1",3,"color","fill","ngClass","click"],["class","margin-left-1","name","information-circle-outline",3,"ngStyle",4,"ngIf"],["shape","round",1,"button-section","btn2",3,"color","fill","ngClass","click"],["shape","round",1,"button-section","btn3",3,"color","fill","ngClass","click"],["shape","round",1,"button-section","btn5",3,"color","fill","ngClass","click"],["slot","end","name","chevron-forward-outline"],["name","information-circle-outline",1,"margin-left-1",3,"ngStyle"],[2,"width","100%","height","10rem",3,"animated"],[1,"pagination-site-back",3,"ngClass","click"],[1,"pagination-site-next",3,"ngClass","click"],["class","section-padding",3,"ngClass",4,"ngIf"],["class","section-padding",4,"ngIf"],["class","section-padding padding-right-0",4,"ngIf"],[1,"section-padding",3,"ngClass"],[1,"background-color-white"],[1,"panel1",3,"size"],["datetime","datetime"],["name","calendar-outline"],[3,"keepContentsMounted"],[1,"margin-top-1"],[1,"description","margin-top-1",3,"ngModel","ionInput","ngModelChange"],[3,"size"],[4,"ngIf"],["presentation","date","id","datetime",3,"value","ionChange"],["show-clear-button","always","placeholder","Buscar proveedor",3,"ionInput"],["lines","none","class","check-provider",3,"ngClass","click",4,"ngFor","ngForOf"],["lines","none",1,"check-provider",3,"ngClass","click"],[1,"check-provider",3,"animated"],[1,"section-padding"],["slot","start",4,"ngIf"],["show-clear-button","always","placeholder","Buscar Cliente",3,"ionInput"],[3,"size",4,"ngFor","ngForOf"],["class","checkbox",3,"click",4,"ngIf"],["class","checkbox selected",3,"click",4,"ngIf"],["class","checkbox partial",3,"click",4,"ngIf"],[1,"checkbox",3,"click"],[1,"checkbox","selected",3,"click"],["name","checkmark-outline"],[1,"checkbox","partial",3,"click"],[1,"triangle","triangle-client"],[1,"checkbox"],[3,"click"],["size","3"],[1,"checkbox",3,"hidden"],["class","checkbox selected",4,"ngIf"],["size","9",1,"client-name"],[1,"checkbox","selected"],[1,"item-title"],[1,"background-color-white",3,"ngClass"],[1,"header-row"],["size","2"],["size","5",1,"ion-text-start"],["size","5"],[4,"ngFor","ngForOf"],[1,"triangle"],["size","2",3,"click"],["placeholder","$ 0.00","type","number",1,"item-input",3,"ngModel","ngModelChange","keyup"],[1,"section-padding","padding-right-0"],[1,"legend"],[1,"color-gray"],[1,"display-flex","margin-top-1"],[1,"margin-bottom-0",3,"ngStyle"],[1,"form-delivery-table","padding-right-0"],[1,"head-row","border-bottom"],["size","4",1,"first-child"],["size","3",1,"last-child"],["class","body-row border-bottom item-row background-color-light-blue",4,"ngIf"],[1,"body-row","border-bottom","item-row","background-color-light-blue"],["size","4",3,"id"],[1,"icon-plus","color-gray",3,"ngClass","click"],["class","icon-plus-line",3,"ngStyle",4,"ngIf"],["size","2",1,"ion-text-center"],["size","3",1,"ion-text-center"],["size","3",1,"ion-text-end"],[1,"icon-plus-line",3,"ngStyle"],["class","body-row border-bottom",4,"ngIf"],[1,"body-row","border-bottom"],["size","4"],["size","2",1,"input-col"],["type","number","placeholder","0","maxlength","4","size","4",3,"ngModel","ngClass","ngModelChange","focus","keyup"],["size","3",1,"input-col"],["type","number","maxlength","4","size","4",3,"ngModel","placeholder","ngClass","ngModelChange","keyup"],[2,"width","100%","height","400rem",3,"animated"]],template:function(i,n){1&i&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2),e._UZ(3,"ion-back-button",3),e.qZA(),e.TgZ(4,"ion-title",4),e.YNc(5,N,5,4,"h6",5),e.qZA(),e.YNc(6,L,1,1,"ion-skeleton-text",6)(7,K,9,4,"ion-buttons",7),e.qZA()(),e.TgZ(8,"ion-content",8)(9,"div",9),e.YNc(10,W,17,33,"div",10)(11,X,1,1,"ion-skeleton-text",11)(12,te,1,3,"div",12)(13,ne,1,4,"div",13)(14,Ue,5,8,"div",14)(15,Fe,1,1,"ion-skeleton-text",15)(16,Ye,1,1,"ion-skeleton-text",11),e.qZA()()),2&i&&(e.Q6J("translucent",!0),e.xp6(4),e.Q6J("ngClass",e.WLB(15,He,n.isSmallScreen,n.isSmallScreen)),e.xp6(1),e.Q6J("ngIf",n.loaded),e.xp6(1),e.Q6J("ngIf",!n.loaded),e.xp6(1),e.Q6J("ngIf",n.loaded),e.xp6(1),e.Q6J("fullscreen",!0),e.xp6(1),e.ekj("active",n.isCardActive),e.xp6(1),e.Q6J("ngIf",n.loaded),e.xp6(1),e.Q6J("ngIf",!n.loaded),e.xp6(1),e.Q6J("ngIf",n.counter>1||n.isPreviousHighlighted),e.xp6(1),e.Q6J("ngIf",4!=n.counter||n.isNextHighlighted),e.xp6(1),e.Q6J("ngIf",n.loaded),e.xp6(1),e.Q6J("ngIf",!n.loaded),e.xp6(1),e.Q6J("ngIf",!n.loaded))},dependencies:[y.mk,y.sg,y.O5,y.PC,m.Fj,m.wV,m.JJ,m.nD,m.On,g.oU,g.yp,g.YG,g.Sm,g.wI,g.W2,g.x4,g.Mj,g.jY,g.Gu,g.gu,g.Ie,g.q_,g.Nd,g.VI,g.CK,g.g2,g.wd,g.sr,g.ki,g.d8,g.QI,g.j9,g.cs,A.DA],styles:['.cd-container[_ngcontent-%COMP%]{position:relative;margin-top:2em;display:flex}.cd-container[_ngcontent-%COMP%]:after{content:"";display:table;clear:both}.cd-container[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:before{content:"";position:absolute;top:.5rem;left:0rem;height:4px;width:80%;background:var(--color-timeline)}.cd-container.portrait[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:before{content:"";position:absolute;top:1.5rem;left:0rem;height:4px;width:80%;background:var(--color-timeline)}.button-section[_ngcontent-%COMP%]{margin:auto;margin-top:-1.3rem;--background-activated: var(--ion-color-primary-shade);--background-focused: var(--ion-color-primary-tint);--border-width: 2px;opacity:1}.cd-container.portrait[_ngcontent-%COMP%]:before{left:0;height:4px;width:100%}@media (orientation: portrait) and (max-width: 480px){.btn1[_ngcontent-%COMP%], .btn2[_ngcontent-%COMP%], .btn3[_ngcontent-%COMP%], .btn4[_ngcontent-%COMP%], .btn5[_ngcontent-%COMP%]{--padding-end: .5rem;--padding-start: .5rem}}.cd-container.portrait[_ngcontent-%COMP%]   .btn1[_ngcontent-%COMP%]{position:relative;top:-1rem}.cd-container.portrait[_ngcontent-%COMP%]   .btn2[_ngcontent-%COMP%]{position:relative;top:3.9rem;right:2rem}.cd-container.portrait[_ngcontent-%COMP%]   .btn3[_ngcontent-%COMP%]{position:relative;top:-1rem;right:2rem}.cd-container.portrait[_ngcontent-%COMP%]   .btn4[_ngcontent-%COMP%]{position:relative;top:4rem;right:calc(10% - 2rem)}.cd-container.portrait[_ngcontent-%COMP%]   .btn5[_ngcontent-%COMP%]{position:relative;top:1.2rem}@media only screen and (max-width: 420px){.cd-container.portrait[_ngcontent-%COMP%]   .btn3[_ngcontent-%COMP%]{right:-1rem}.cd-container.portrait[_ngcontent-%COMP%]   .btn4[_ngcontent-%COMP%]{right:4rem}.cd-container.portrait[_ngcontent-%COMP%]   .btn5[_ngcontent-%COMP%]{position:relative;top:3.9rem;right:3.7rem}.cd-container.portrait[_ngcontent-%COMP%]   .btn5.client-bag[_ngcontent-%COMP%]{right:3.7rem}.cd-container.portrait[_ngcontent-%COMP%]   .btn5.item-bag[_ngcontent-%COMP%]{right:4.9rem}.cd-container.portrait[_ngcontent-%COMP%]   .btn5[_ngcontent-%COMP%]:before{content:"";position:absolute;top:-1rem;left:29px;height:100%;width:3px;background:var(--color-timeline)}}@media only screen and (max-width: 365px){.cd-container.portrait[_ngcontent-%COMP%]   .btn3[_ngcontent-%COMP%]{right:1.1rem}.cd-container.portrait[_ngcontent-%COMP%]   .btn5[_ngcontent-%COMP%]{right:5.9rem}.cd-container.portrait[_ngcontent-%COMP%]   .btn5.client-bag[_ngcontent-%COMP%]{right:5.8rem}.cd-container.portrait[_ngcontent-%COMP%]   .btn5.item-bag[_ngcontent-%COMP%]{right:7rem}}.cd-container.portrait[_ngcontent-%COMP%]   .btn1[_ngcontent-%COMP%]:before, .cd-container.portrait[_ngcontent-%COMP%]   .btn2[_ngcontent-%COMP%]:before, .cd-container.portrait[_ngcontent-%COMP%]   .btn3[_ngcontent-%COMP%]:before, .cd-container.portrait[_ngcontent-%COMP%]   .btn4[_ngcontent-%COMP%]:before{content:"";position:absolute;top:13px;left:28px;height:100%;width:3px;background:var(--color-timeline)}.cd-container.portrait[_ngcontent-%COMP%]   .btn2[_ngcontent-%COMP%]:before, .cd-container.portrait[_ngcontent-%COMP%]   .btn4[_ngcontent-%COMP%]:before{top:-1rem}.cd-container.portrait[_ngcontent-%COMP%]:before{top:23px}.button-section.disabled[_ngcontent-%COMP%]::part(native){background:white}.padding-top-0[_ngcontent-%COMP%]{padding-top:0}.transaction-date[_ngcontent-%COMP%]{display:flex}.transaction-date[_ngcontent-%COMP%]   ion-datetime-button[_ngcontent-%COMP%]{margin-left:1rem}.client-name[_ngcontent-%COMP%]{margin-top:.4rem}.panel1[_ngcontent-%COMP%]{padding-left:1rem;padding-right:1rem}ion-modal[_ngcontent-%COMP%]{color:#000}ion-datetime[_ngcontent-%COMP%]{--background: #fff1f2;--background-rgb: 255, 241, 242;border-radius:16px;box-shadow:rgba(var(--ion-color-rose-rgb),.3) 0 10px 15px -3px}.description[_ngcontent-%COMP%]{border:1px solid gray;border-radius:14px;padding:1rem}.section-padding[_ngcontent-%COMP%]{padding-inline-start:1rem;padding-inline-end:1rem;padding-top:.5rem;margin-top:1rem;min-height:100vh}h2[_ngcontent-%COMP%]{margin-bottom:1rem;margin-top:.5rem}.price-mark[_ngcontent-%COMP%]{padding-right:2rem}.item-title[_ngcontent-%COMP%]{margin:0;margin-bottom:1rem}.item-input[_ngcontent-%COMP%]{border:1px solid gray;border-radius:11px;margin-left:0;height:2rem;background-color:#fff;width:100%;padding-left:2rem}.check-provider[_ngcontent-%COMP%]{border:1px solid gray;border-radius:16px;margin-bottom:.8rem;min-height:2.8rem}.check-provider.select[_ngcontent-%COMP%]{--background: var(--ion-color-primary-tint);color:var(--ion-color-primary-contrast)}ion-checkbox[_ngcontent-%COMP%]{--size: 32px;--checkbox-background-checked: #6815ec}ion-checkbox[_ngcontent-%COMP%]::part(container){border-radius:6px;border:2px solid #6815ec}.checkbox-item[_ngcontent-%COMP%]{border-bottom:1px solid lightgray}.checkbox[_ngcontent-%COMP%]{width:2rem;height:2rem;border-radius:6px;border:2px solid #6815ec}.checkbox-item[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{margin-right:1rem;text-align:right}.checkbox.selected[_ngcontent-%COMP%]{border-radius:6px;border:2px solid #6815ec;background:#6815ec;color:#fff;font-size:1.5rem;text-align:center}.border-bottom[_ngcontent-%COMP%]{border-bottom:1px solid lightgray;border-right:1px solid lightgray;border-left:1px solid lightgray}.form-delivery-table[_ngcontent-%COMP%]{font-size:.8rem}.form-delivery-table[_ngcontent-%COMP%]   .item-row[_ngcontent-%COMP%]{text-transform:uppercase;font-weight:500}.form-delivery-table[_ngcontent-%COMP%]   .head-row[_ngcontent-%COMP%]{text-transform:uppercase;background-color:var(--ion-color-warning);color:var(--ion-color-warning-contrast);font-weight:500;text-align:center;border-top-left-radius:.5rem;border-top-right-radius:.5rem}.form-delivery-table[_ngcontent-%COMP%]   .head-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{padding:.5rem}.form-delivery-table[_ngcontent-%COMP%]   .body-row[_ngcontent-%COMP%]{padding:0 1rem}.form-delivery-table[_ngcontent-%COMP%]   .body-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{margin:0;padding-left:0;padding-right:0;padding-top:.8rem}.form-delivery-table[_ngcontent-%COMP%]   .body-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;background-color:#fff;color:#000;border:1px solid gray;border-radius:9px;height:1.6rem;padding-left:1rem}.form-delivery-table[_ngcontent-%COMP%]   .input-col[_ngcontent-%COMP%]{padding-left:1%!important;padding-right:1%!important;padding-top:.6rem!important}.triangle[_ngcontent-%COMP%]{border-right:1.88rem solid #6815ec;border-top:2rem solid transparent;position:absolute;top:.3rem;border-radius:6px}.triangle-client[_ngcontent-%COMP%]{top:0rem;left:0rem}.button-next-form[_ngcontent-%COMP%]{position:absolute;right:-3rem;font-size:2rem;top:-2.3rem}.button-next-form[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--color-timeline)}.button-next-form[_ngcontent-%COMP%]::part(native){padding-left:0}.legend[_ngcontent-%COMP%]{margin-top:-1rem}.legend[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%]{margin-top:.2rem!important}.title-float[_ngcontent-%COMP%]{position:absolute;top:-.6rem}.price-float[_ngcontent-%COMP%]{position:absolute;top:1.3rem;left:100%;width:100%;transform:translate(-100%)}.pagination-site-back[_ngcontent-%COMP%]:before, .pagination-site-next[_ngcontent-%COMP%]:before{content:"";position:fixed!important;top:50%;border-style:solid;opacity:.25;z-index:10}.pagination-site-back[_ngcontent-%COMP%]:before{border-width:4rem .67em 5rem 0;border-color:transparent #808080 transparent transparent;margin-left:-.4em}.pagination-site-next[_ngcontent-%COMP%]:before{border-width:4rem 0 4rem .67em;border-color:transparent transparent transparent #808080;margin-left:calc(100% - 3rem)!important}.pagination-site-next-landscape[_ngcontent-%COMP%]:before{border-width:4rem 0 4rem .67em;border-color:transparent transparent transparent #808080;margin-left:calc(82% - 3rem)!important}.icon-plus[_ngcontent-%COMP%]{position:absolute;left:-2rem;font-size:1.4rem;top:.3rem}.icon-plus-line[_ngcontent-%COMP%]{position:absolute;margin-left:-1.6rem!important;margin-top:1.2rem}.icon-plus-line[_ngcontent-%COMP%]:before{content:"";position:absolute;height:100%;width:2px;background:lightgray}.icon-plus.small[_ngcontent-%COMP%]{font-size:3rem;top:-.7rem;left:-2rem}.pagination-site-next.highlight[_ngcontent-%COMP%]:before{box-shadow:-11px 0 19px 2px #fc0;border-color:transparent transparent transparent #ffcc00}.pagination-site-back.highlight[_ngcontent-%COMP%]:before{box-shadow:8px 0 19px 2px #fc0;border-color:transparent #ffcc00 transparent transparent}.input-trx-price[_ngcontent-%COMP%]{background-color:bisque!important}'],data:{animation:[x.sq]}})}return o})()}];let Ke=(()=>{class o{static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275mod=e.oAB({type:o});static#i=this.\u0275inj=e.cJS({imports:[w.Bz.forChild(Ee),w.Bz]})}return o})();var Ge=p(8434);let ze=(()=>{class o{static#e=this.\u0275fac=function(i){return new(i||o)};static#t=this.\u0275mod=e.oAB({type:o});static#i=this.\u0275inj=e.cJS({imports:[y.ez,m.u5,g.Pc,Ge.K,Ke]})}return o})()}}]);