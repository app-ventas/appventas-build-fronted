"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5253],{5253:(D,T,l)=>{l.r(T),l.d(T,{TransactionConfigPageModule:()=>H});var p=l(6814),m=l(95),r=l(2912),h=l(7168),d=l(5861),y=l(5083),n=l(5678),_=l(8439),x=l(8168),Z=l(4387);const b=["searchbar"],v=["popoverTransaction"];function P(i,c){1&i&&(n.TgZ(0,"ion-title"),n._uU(1,"Transacciones de Venta"),n.qZA())}function A(i,c){1&i&&(n.TgZ(0,"h6",16),n._uU(1,"Transacciones de Venta"),n.qZA())}function S(i,c){1&i&&n._UZ(0,"br")}function w(i,c){1&i&&(n.TgZ(0,"ion-col"),n._uU(1,"Precio"),n.qZA())}function J(i,c){if(1&i&&(n.ynx(0),n.TgZ(1,"ion-col",31),n._uU(2," Nombre: "),n.qZA(),n.TgZ(3,"ion-col",32),n._uU(4),n.qZA(),n.TgZ(5,"ion-col",31),n._uU(6," Precio: "),n.qZA(),n.TgZ(7,"ion-col",32),n._uU(8),n.ALo(9,"COP"),n.qZA(),n.BQk()),2&i){const t=n.oxw().$implicit;n.xp6(4),n.hij(" ",t.name," "),n.xp6(4),n.hij(" ",n.lcZ(9,2,t.price)," ")}}function O(i,c){if(1&i&&(n.ynx(0),n.TgZ(1,"ion-col",33),n._uU(2),n.qZA(),n.TgZ(3,"ion-col",33),n._uU(4),n.ALo(5,"COP"),n.qZA(),n.BQk()),2&i){const t=n.oxw().$implicit;n.xp6(2),n.hij(" ",t.name," "),n.xp6(2),n.hij(" ",n.lcZ(5,2,t.price)," ")}}const Q=i=>({"border-bottom":i});function M(i,c){if(1&i&&(n.TgZ(0,"ion-row",30),n.YNc(1,J,10,4,"ng-container",3)(2,O,6,4,"ng-container",3),n.qZA()),2&i){const t=n.oxw(5);n.Q6J("ngClass",n.VKq(3,Q,t.isSmallScreen)),n.xp6(1),n.Q6J("ngIf",t.isSmallScreen),n.xp6(1),n.Q6J("ngIf",!t.isSmallScreen)}}function U(i,c){if(1&i&&(n.ynx(0),n.YNc(1,M,3,5,"ion-row",29),n.BQk()),2&i){const t=n.oxw(2).$implicit;n.xp6(1),n.Q6J("ngForOf",t.transactionType.productCatalogs)}}function q(i,c){1&i&&(n.TgZ(0,"ion-row",34)(1,"ion-col",35),n._uU(2,"Asigna una categor\xeda a este producto"),n.qZA()())}const I=i=>({removed:i});function k(i,c){if(1&i&&(n.TgZ(0,"ion-item",25)(1,"ion-grid",26),n._uU(2," Categorias Asociadas: "),n.TgZ(3,"ion-row",27)(4,"ion-col"),n._uU(5,"Categor\xedas de venta"),n.qZA(),n.YNc(6,w,2,0,"ion-col",3),n.qZA(),n.YNc(7,U,2,1,"ng-container",3)(8,q,3,0,"ion-row",28),n.qZA()()),2&i){const t=n.oxw().$implicit,o=n.oxw(2);n.Q6J("ngClass",n.VKq(4,I,"B"==t.transactionType.state)),n.xp6(6),n.Q6J("ngIf",!o.isSmallScreen),n.xp6(1),n.Q6J("ngIf",t.transactionType&&t.transactionType.productCatalogs),n.xp6(1),n.Q6J("ngIf",0==(null==t.transactionType||null==t.transactionType.productCatalogs?null:t.transactionType.productCatalogs.length))}}const L=(i,c)=>({"margin-top-2 ":i,removed:c});function N(i,c){if(1&i){const t=n.EpF();n.ynx(0),n.TgZ(1,"ion-item",21)(2,"ion-buttons",4)(3,"ion-button",22),n.NdJ("click",function(e){const a=n.CHM(t),s=a.index,g=a.$implicit,u=n.oxw(2);return n.KtG(u.presentPopoverAction(e,s,g))}),n._UZ(4,"ion-icon",23),n.qZA()(),n.TgZ(5,"ion-label")(6,"strong"),n._uU(7,"Tipo de Transacci\xf3n: "),n.qZA(),n.YNc(8,S,1,0,"br",3),n.TgZ(9,"span"),n._uU(10),n.qZA()()(),n.YNc(11,k,9,6,"ion-item",24),n.BQk()}if(2&i){const t=c.$implicit,o=c.index,e=n.oxw(2);n.xp6(1),n.Q6J("ngClass",n.WLB(4,L,o>=1,"A"!==t.transactionType.state)),n.xp6(7),n.Q6J("ngIf",e.isSmallScreen),n.xp6(2),n.Oqu(t.transactionType.name),n.xp6(1),n.Q6J("ngIf",t.transactionType.productCatalogs&&t.transactionType.productCatalogs.length>0)}}function F(i,c){if(1&i){const t=n.EpF();n.TgZ(0,"ion-item",37),n.NdJ("click",function(){n.CHM(t);const e=n.oxw(4);return n.KtG(e.presentModifyTransactionType(e.transactionTypeSelectedCss.transactionType,"B"))}),n.TgZ(1,"ion-label"),n._uU(2,"Borrar"),n.qZA(),n._UZ(3,"ion-icon",40),n.qZA()}2&i&&n.Q6J("button",!0)("detail",!1)}function Y(i,c){if(1&i){const t=n.EpF();n.TgZ(0,"ion-item",37),n.NdJ("click",function(){n.CHM(t);const e=n.oxw(4);return n.KtG(e.presentModifyTransactionType(e.transactionTypeSelectedCss.transactionType,"A"))}),n.TgZ(1,"ion-label"),n._uU(2,"Activar"),n.qZA(),n._UZ(3,"ion-icon",41),n.qZA()}2&i&&n.Q6J("button",!0)("detail",!1)}function z(i,c){if(1&i){const t=n.EpF();n.TgZ(0,"ion-content",36)(1,"ion-list")(2,"ion-item",37),n.NdJ("click",function(){n.CHM(t);const e=n.oxw(3);return n.KtG(e.goToTransactionType(e.transactionTypeSelectedCss.transactionType))}),n.TgZ(3,"ion-label"),n._uU(4,"Editar"),n.qZA(),n._UZ(5,"ion-icon",38),n.qZA(),n.YNc(6,F,4,2,"ion-item",39)(7,Y,4,2,"ion-item",39),n.qZA()()}if(2&i){const t=n.oxw(3);n.xp6(2),n.Q6J("button",!0)("detail",!1),n.xp6(4),n.Q6J("ngIf","A"==t.transactionTypeSelectedCss.transactionType.state),n.xp6(1),n.Q6J("ngIf","A"!==t.transactionTypeSelectedCss.transactionType.state)}}function B(i,c){1&i&&n.YNc(0,z,8,4,"ng-template")}const C=i=>({"ion-padding-landscape-small":i});function G(i,c){if(1&i){const t=n.EpF();n.TgZ(0,"ion-list",17),n.YNc(1,N,12,7,"ng-container",18),n.TgZ(2,"ion-popover",19,20),n.NdJ("didDismiss",function(){n.CHM(t);const e=n.oxw();return n.KtG(e.isOpen=!1)}),n.YNc(4,B,1,0,null,3),n.qZA()()}if(2&i){const t=n.oxw();n.Q6J("inset",!0)("ngClass",n.VKq(5,C,t.isLandscape)),n.xp6(1),n.Q6J("ngForOf",t._transactionTypeFilter),n.xp6(1),n.Q6J("isOpen",t.isOpen),n.xp6(2),n.Q6J("ngIf",t.transactionTypeSelectedCss&&t.transactionTypeSelectedCss.transactionType)}}function E(i,c){if(1&i&&(n.TgZ(0,"ion-grid",42)(1,"ion-row")(2,"ion-col",43),n._UZ(3,"ion-skeleton-text",44),n.qZA(),n.TgZ(4,"ion-col",43),n._UZ(5,"ion-skeleton-text",44),n.qZA(),n.TgZ(6,"ion-col",43),n._UZ(7,"ion-skeleton-text",44),n.qZA()()()),2&i){const t=n.oxw();n.xp6(2),n.Q6J("size",t.isLandscape?5:12),n.xp6(1),n.Q6J("animated",!0),n.xp6(1),n.Q6J("size",t.isLandscape?5:12),n.xp6(1),n.Q6J("animated",!0),n.xp6(1),n.Q6J("size",t.isLandscape?5:12),n.xp6(1),n.Q6J("animated",!0)}}const K=[{path:"",component:(()=>{class i{constructor(t,o,e,a,s){this.screenSizeService=t,this.storageService=o,this.redirectService=e,this.dialogService=a,this.apiService=s,this.isOpen=!1,this.loading=!1,this.isLandscape=!1,this.isSmallScreen=!1}ionViewDidEnter(){var t=this;return(0,d.Z)(function*(){t.redirectService.routerNameChange("config"),t.userAuth=yield t.storageService.getUserAuth(),t.isLandscape=t.screenSizeService.isLandscape,t.isSmallScreen=t.screenSizeService.isSmallScreen,t.screenSizeService.isLandscape$.subscribe(o=>{t.isLandscape=o.isLandscape,t.isSmallScreen=o.isSmallScreen}),t.initializeTransactionTypes()})()}initializeTransactionTypes(){var t=this;return(0,d.Z)(function*(){t.productCatalogOri=yield t.storageService.getProductCatalogs(t.userAuth);const o=yield t.storageService.getTransactionTypes(t.userAuth);let e=yield t.storageService.getTransactions(t.userAuth);t.transactionTypesOri=o?.filter(s=>s.targetType==y.Lm.Credit)?.map(s=>{const g=t.productCatalogOri?.filter(f=>!!s.product_catalog_ids&&s.product_catalog_ids.some($=>f.id==$));let u=!1;if(e)for(let f of e)if(f.transaction_type_id==s.id){u=!0;break}return{checked:u,transactionType:{...s,state:s.state||"A",productCatalogs:g,detail:s.product_catalog_ids&&s.product_catalog_ids.length>0?1:0}}}),t._transactionTypeFilter=t.transactionTypesOri?.sort((s,g)=>"B"==s.transactionType.state&&"A"==g.transactionType.state?1:"A"==s.transactionType.state&&"B"==g.transactionType.state?-1:0),t.loading=!0})()}findProductsSearch(t){const o=(t.target.value||"").trim().toLowerCase();this.transactionTypesOri&&(this._transactionTypeFilter=this.transactionTypesOri.filter(e=>e.transactionType.name?.toLowerCase().includes(o)||e.transactionType.productCatalogs?.some(a=>a.name.toLowerCase()?.includes(o))))}goToTransactionType(t){this.closePopover(),this.redirectService.redirectTo("transaction-type-edit",t?{action:"Modify",transactionTypeId:t.id}:{action:"Add"})}presentModifyTransactionType(t,o){var a,e=this;this.closePopover(),"A"==o?(t.state=o,this.modifyTransactionType(t,o)):this.dialogService.showAlert({header:"Borrar Transacci\xf3n de Venta?",subHeader:"\xbfSeguro que desea  borrar la transacci\xf3n?",buttons:[{text:"Cancelar",cssClass:"alert-button-cancel",role:"cancel",handler:()=>{}},{text:"Borrar",cssClass:"alert-success-confirm",handler:(a=(0,d.Z)(function*(){t.state=o,e.modifyTransactionType(t,o)}),function(){return a.apply(this,arguments)})}]})}modifyTransactionType(t,o){var e=this;return(0,d.Z)(function*(){const a=yield e.dialogService.showLoading(),s=yield e.apiService.saveTransactionType([t]).catch(()=>{});t.state=o,t.syncRequired=!!s,e.storageService.pushTransactionTypes(e.userAuth,t,t.id),a.dismiss(),e.initializeTransactionTypes()})()}findTransactionTypeSearch(t){const o=(t.target.value||"").trim().toLowerCase();this._transactionTypeFilter=o&&o.length>0?this.transactionTypesOri?.filter(e=>e.transactionType?.name?.toLowerCase().includes(o)||e.transactionType.productCatalogs?.some(a=>a.name.toLowerCase().includes(o))):this.transactionTypesOri}presentPopoverAction(t,o,e){this.transactionTypeSelectedCss=e,this.popoverTransaction&&(this.popoverTransaction.event=t),this.isOpen=!0}closePopover(){this.popoverTransaction&&this.popoverTransaction.dismiss()}loadMore(t){setTimeout(()=>{let o=[1,2,3,4,5,6,7,8,9];new Array(o.length).fill(o.length).forEach(a=>{o.push(a)}),t.target.complete()},1e3)}static#n=this.\u0275fac=function(o){return new(o||i)(n.Y36(_.O6),n.Y36(_.V1),n.Y36(_.VH),n.Y36(_.xA),n.Y36(_.sM))};static#t=this.\u0275cmp=n.Xpm({type:i,selectors:[["app-transaction-type-config"]],viewQuery:function(o,e){if(1&o&&(n.Gf(b,5),n.Gf(v,5),n.Gf(r.d8,5)),2&o){let a;n.iGM(a=n.CRH())&&(e.searchbar=a.first),n.iGM(a=n.CRH())&&(e.popoverTransaction=a.first),n.iGM(a=n.CRH())&&(e.ionPopovers=a)}},decls:19,vars:9,consts:[[3,"translucent"],[1,"ion-padding-landscape-head"],["slot","start"],[4,"ngIf"],["slot","end"],["color","primary","fill","solid","size","small",1,"button-new",3,"click"],["slot","end","name","add-circle-outline"],["color","light",1,"ion-padding",3,"fullscreen"],["class","ion-text-center",4,"ngIf"],[1,"sticky",3,"ngClass"],["show-clear-button","always","placeholder","Buscar",3,"ionInput"],["searchbar",""],["class","ion-padding-landscape background-color-transparent margin-top-0",3,"inset","ngClass",4,"ngIf"],["class","ion-padding-landscape",4,"ngIf"],["position","bottom","threshold","30%",3,"ionInfinite"],["loadingSpinner","crescent","loadingText","Cargando m\xe1s datos..."],[1,"ion-text-center"],[1,"ion-padding-landscape","background-color-transparent","margin-top-0",3,"inset","ngClass"],[4,"ngFor","ngForOf"],[3,"isOpen","didDismiss"],["popoverTransaction",""],[1,"margin-top-1","background-color-white",3,"ngClass"],["fill","clear","slot","end","size","small",3,"click"],["slot","icon-only","name","ellipsis-vertical-outline"],["class","margin-bottom-1 background-color-white","lines","none",3,"ngClass",4,"ngIf"],["lines","none",1,"margin-bottom-1","background-color-white",3,"ngClass"],[1,"table","margin-bottom-1"],[1,"row-head","background-color-light-blue","margin-top-1"],["class","row-body  ion-text-center",4,"ngIf"],["class","row-body",3,"ngClass",4,"ngFor","ngForOf"],[1,"row-body",3,"ngClass"],["size","5"],["size","7"],["size","5",1,"margin-02","ion-text-center"],[1,"row-body","ion-text-center"],["span","3"],[1,"ion-padding"],[3,"button","detail","click"],["slot","end","name","open-outline"],[3,"button","detail","click",4,"ngIf"],["slot","end","name","trash-outline"],["slot","end","name","sync-outline"],[1,"ion-padding-landscape"],[3,"size"],[2,"width","100%",3,"animated"]],template:function(o,e){1&o&&(n.TgZ(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2),n._UZ(3,"app-icon-logo"),n.qZA(),n.YNc(4,P,2,0,"ion-title",3),n.TgZ(5,"ion-buttons",4)(6,"ion-button",5),n.NdJ("click",function(){return e.goToTransactionType()}),n._uU(7," Agregar Transacci\xf3n "),n._UZ(8,"ion-icon",6),n.qZA(),n._UZ(9,"ion-menu-button"),n.qZA()()(),n.TgZ(10,"ion-content",7),n.YNc(11,A,2,0,"h6",8),n.TgZ(12,"ion-item",9)(13,"ion-searchbar",10,11),n.NdJ("ionInput",function(s){return e.findTransactionTypeSearch(s)}),n.qZA()(),n.YNc(15,G,5,7,"ion-list",12)(16,E,8,6,"ion-grid",13),n.TgZ(17,"ion-infinite-scroll",14),n.NdJ("ionInfinite",function(s){return e.loadMore(s)}),n._UZ(18,"ion-infinite-scroll-content",15),n.qZA()()),2&o&&(n.Q6J("translucent",!0),n.xp6(4),n.Q6J("ngIf",e.isLandscape),n.xp6(6),n.Q6J("fullscreen",!0),n.xp6(1),n.Q6J("ngIf",!e.isLandscape),n.xp6(1),n.Q6J("ngClass",n.VKq(7,C,e.isLandscape)),n.xp6(3),n.Q6J("ngIf",e.loading),n.xp6(1),n.Q6J("ngIf",!e.loading))},dependencies:[p.mk,p.sg,p.O5,r.YG,r.Sm,r.wI,r.W2,r.jY,r.Gu,r.gu,r.ju,r.MB,r.Ie,r.Q$,r.q_,r.fG,r.Nd,r.VI,r.CK,r.wd,r.sr,r.d8,r.j9,x.S,Z.DA],styles:[".product-catalog[_ngcontent-%COMP%]{margin:.3rem;padding:.5rem;border:1px solid;display:flex;border-radius:.5rem}.product-catalog[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{margin-left:7px}.bnt-new[_ngcontent-%COMP%]{height:1.5rem}.icon-new[_ngcontent-%COMP%]{font-size:1.5rem}-------------------[_ngcontent-%COMP%]   .product-catalog[_ngcontent-%COMP%]{width:93%;max-width:1170px;margin:0 auto}.row-head[_ngcontent-%COMP%]{border:1px solid gray;border-top-right-radius:12px;border-top-left-radius:12px;background-color:#d3d3d3;height:2rem;text-align:center;font-weight:700}.row-head[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{height:.5rem}.row-body[_ngcontent-%COMP%]{justify-content:center;border-left:1px solid gray;border-right:1px solid gray}.table[_ngcontent-%COMP%]   .row-body[_ngcontent-%COMP%]:last-child{border-bottom:1px solid gray;border-bottom-right-radius:12px;border-bottom-left-radius:12px}.table[_ngcontent-%COMP%]   .row-body[_ngcontent-%COMP%]:last-child{padding-bottom:17px}.table[_ngcontent-%COMP%]   .row-body[_ngcontent-%COMP%]:first-child{padding-top:10px}.removed[_ngcontent-%COMP%]{--background: rgb(211,211,211,.1) !important;background-color:#d3d3d31a!important;opacity:.3}"]})}return i})()}];let V=(()=>{class i{static#n=this.\u0275fac=function(o){return new(o||i)};static#t=this.\u0275mod=n.oAB({type:i});static#i=this.\u0275inj=n.cJS({imports:[h.Bz.forChild(K),h.Bz]})}return i})();var j=l(8434);let H=(()=>{class i{static#n=this.\u0275fac=function(o){return new(o||i)};static#t=this.\u0275mod=n.oAB({type:i});static#i=this.\u0275inj=n.cJS({imports:[p.ez,m.u5,r.Pc,j.K,m.UX,V]})}return i})()}}]);